{% load static %}
<link rel="stylesheet" href="{% static 'css/signin_integrated.css' %}">
<script src="{% static 'js/sign_integrated1.js' %}"></script>
<div class="modal fade d-example-modal-lg" id="signin-integrated" tabindex="-1" role="dialog"
     aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content">
            <!-- Form-->
            <div class="form" id="login-form">
                <div class="form-toggle"></div>
                <div class="form-panel one">
                    <div class="form-header">
                        <h1>Account Login</h1>
                    </div>
                    <div class="form-content">
                        <form>
                            <div class="form-group">
                                <label for="email">Email Address</label>
                                <input type="email" id="email" name="email" placeholder="Your email"
                                       required="required"/>
                                <div id="email-err" style="color: indianred">
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="password">Password</label>
                                <input type="password" id="password" name="password" placeholder="Password"
                                       required="required"/>
                                <div id="password-err" style="color: indianred">
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="form-remember">
                                </label><a class="form-recovery" href="#">Forgot Password?</a>
                            </div>
                            <div class="form-group">
                                <button id="login-btn" type="button">Log In</button>
                            </div>
                        </form>
                    </div>
                </div>
                <div class="form-panel two">
                    <div class="form-header">
                        <h1>Register Account</h1>
                    </div>
                    <div class="form-content">
                        <form>
                            <div class="form-group">
                                <label for="email">Email Address</label>
                                <input type="email" id="email-U" name="email" required="required"/>
                            </div>
                            <div class="form-group">
                                <label for="password">Password</label>
                                <input type="password" id="password-U" name="password" required="required"/>
                            </div>
                            <div class="form-group">
                                <label for="cpassword">Confirm Password</label>
                                <input type="password" id="cpassword" name="cpassword" required="required"/>
                            </div>
                            <div class="form-group">
                                <button id="signup-btn" type="button">Register</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    function reload(){
        window.location.reload();
    }
    $("#login-btn").on('click', function () {
        var email = document.getElementById('email').value;
        var password = document.getElementById('password').value;
        $.ajax({
            type: 'post',
            url: "{% url 'userlogin' %}",
            data: {
                csrfmiddlewaretoken: '{{ csrf_token }}',
                'email': email,
                'password': password,
            },
            dataType: 'json',
            success: function (data) {
                if (data.successful) {
                    //alert('success!');
                    var usr_a = "<a class=\"nav-link usrname\"\n" +
                        "               href=\"usr/profile/u=";
                    var usr_b = "\">Hello, ";
                    var usr_c = "</a>";
                    var logout = "<a class=\"nav-link active\" id='logout' onclick=\"logout()\">Logout</a>";
                    document.getElementById('usrname-top').innerHTML = usr_a + data.account_id + usr_b + data.name + usr_c;
                    document.getElementById('signin-out').innerHTML = logout;
                    $('#login-form').load('/templates/signin_successful.html');

                } else {
                    document.getElementById('email-err').innerHTML = data.dne_err;
                    document.getElementById('password-err').innerHTML = data.password_err;
                }
            }
        })
    });


</script>